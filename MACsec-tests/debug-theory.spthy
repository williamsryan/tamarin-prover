theory MACsec_Debug
begin

section{* Tester for MACsec stuff. *}

/*
 *
 * Protocol:	MACsec
 *
 * Based on:    Component-Based Formal Analysis of 5G-AKA:
 *              Channel Assumptions and Session Confusion
 *
 * Channels:    TODO
 *
 * Functions:   TODO
 *
 * Modeler: 	Ryan Williams
 * Date: 	    May 2023
 *
 * Status: 	    DEVELOPMENTAL
 *
 */

 builtins:
    multiset

 functions:
    h1/2,   // Define a hash function, h1, that takes two parameters and is one-way.
    KDF/1   // TODO KDF function.


 // This is a standard, secure channel abstraction, as previously used in work 
 // by Basin, Radomirovic, and Schmid: Modeling Human Errors in Security Protocols
 // (CSF 2016)
 // Normal Send Secure and Receive Secure rules.
 // Model: "normal channels"
 rule send_secure:
    [F_SndS(<channelname, SendType, ReceiveType>, A, B, m)]
    --[SendSecure(channelname, A, B, m)]->
    [Sec(<channelname, SendType, ReceiveType>, A, B, m)]

 rule receive_secure:
    [Sec(<channelname, SendType, ReceiveType>, A, B, m)]
    --[ReceiveSecure(channelname, A, B, m)]->
    [F_RcvS(<channelname, SendType, ReceiveType>, A, B, m)]

 // Holds.
 lemma rand_autn_src [sources]:
    " All RAND AUTN #i. Out_Src(RAND, AUTN)@i
        ==> (Ex #j. Src(RAND, AUTN)@j & j < i)
        | (Ex #j. KU(RAND)@j & j < i)
        | (Ex #j. KU(AUTN)@j & j < i)
        | (Ex #j #k . KU(AUTN)@j & j < i
                    & KU(RAND)@k & k < i)
    "

end
